<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Notificaciones - Baraka Lashes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Tu CSS personalizado -->
  <link rel="stylesheet" href="/css/style.css">

  <!-- SockJS y STOMP -->
  <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
</head>
<body>

<div class="container py-5">
  <div class="text-center mb-4">
    <h1 class="fw-bold brand-title">Baraka Lashes üëÅÔ∏è</h1>
    <h4 class="text-muted">Notificaciones de tus citas</h4>
  </div>

  <div class="card mx-auto" style="max-width: 600px;">
    <div class="card-body">
      <h5 class="card-title text-center">üîî Recordatorios</h5>
      <div id="notificaciones" class="mt-3">
        <p class="text-center text-muted">Esperando notificaciones...</p>
      </div>
    </div>
  </div>
</div>

<script>
    // Email del usuario autenticado (en una app real viene del backend)
    const userEmail = "cliente@barakalashes.com";

    // Conexi√≥n al endpoint configurado en tu backend
    const socket = new SockJS('/citas/notificaciones');
    const stompClient = Stomp.over(socket);

    stompClient.connect({}, function (frame) {
        console.log('‚úÖ Conectado:', frame);
        stompClient.subscribe('/topic/notificaciones/' + userEmail, function (notificacion) {
            mostrarNotificacion(notificacion.body);
        });
    }, function (error) {
        console.error('‚ùå Error al conectar:', error);
    });

    function mostrarNotificacion(mensaje) {
        const contenedor = document.getElementById("notificaciones");

        // Elimina el texto inicial si es la primera notificaci√≥n
        if (contenedor.children.length === 1 && contenedor.firstElementChild.tagName === 'P') {
            contenedor.innerHTML = '';
        }

        const alerta = document.createElement("div");
        alerta.classList.add("alert", "alert-info", "mb-2");
        alerta.textContent = mensaje;
        contenedor.prepend(alerta);
    }
</script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
